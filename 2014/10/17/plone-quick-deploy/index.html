
<!DOCTYPE html>
<html lang="zh-CN">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="阿泰的菜园">
    <title>plone快速部署 - 阿泰的菜园</title>
    <meta name="author" content="阿泰">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="最近想实现一个个人网站 “图志”，来搜集和整理有一天会去亲眼看看的世界的历史、文化和自然景观的资料。这个网站虽然也可以简单用WordPress来实现，但是我还是想能够做一个更为完善的平台，能够持续地运作并且借此机会提高在知识管理、CMS、Python方面的技能。
Plone平台是开源的CMS平台，适合企业级的应用，有完善的权限管理以及流程支持，是目前开源CMS的翘楚。虽然个人网站极为渺小，但是通过">
<meta property="og:type" content="blog">
<meta property="og:title" content="plone快速部署">
<meta property="og:url" content="http://blog.huatai.me/2014/10/17/plone-quick-deploy/index.html">
<meta property="og:site_name" content="阿泰的菜园">
<meta property="og:description" content="最近想实现一个个人网站 “图志”，来搜集和整理有一天会去亲眼看看的世界的历史、文化和自然景观的资料。这个网站虽然也可以简单用WordPress来实现，但是我还是想能够做一个更为完善的平台，能够持续地运作并且借此机会提高在知识管理、CMS、Python方面的技能。
Plone平台是开源的CMS平台，适合企业级的应用，有完善的权限管理以及流程支持，是目前开源CMS的翘楚。虽然个人网站极为渺小，但是通过">
<meta property="og:image" content="http://blog.huatai.me/img/plone/plone_init.png">
<meta property="og:updated_time" content="2016-02-09T14:32:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="plone快速部署">
<meta name="twitter:description" content="最近想实现一个个人网站 “图志”，来搜集和整理有一天会去亲眼看看的世界的历史、文化和自然景观的资料。这个网站虽然也可以简单用WordPress来实现，但是我还是想能够做一个更为完善的平台，能够持续地运作并且借此机会提高在知识管理、CMS、Python方面的技能。
Plone平台是开源的CMS平台，适合企业级的应用，有完善的权限管理以及流程支持，是目前开源CMS的翘楚。虽然个人网站极为渺小，但是通过">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-ejlztp1tasruqfvoz6xmgqng0anzae8ox7cqjj5yibieqgcmhe9fwxfae6zj.min.css" type="text/css">
    <!--STYLES END-->
    
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">阿泰的菜园</a>
    </h1>
    
        
            <a  class="header-right-picture "
                href="/#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">首頁</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">分類</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">標籤</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">所有文章</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link st-search-show-outputs"
                         href="/#search"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                    <span class="sidebar-button-desc">搜尋</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">關於</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">Atom</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            plone快速部署
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" content="Fri Oct 17 2014 09:13:59 GMT+0800">
	
		    10月 17, 2014
    	
    </time>
    
</div>
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>最近想实现一个个人网站 <a href="http://atlas.huatai.me" target="_blank" rel="external">“图志”</a>，来搜集和整理有一天会去亲眼看看的世界的历史、文化和自然景观的资料。这个网站虽然也可以简单用WordPress来实现，但是我还是想能够做一个更为完善的平台，能够持续地运作并且借此机会提高在知识管理、CMS、Python方面的技能。</p>
<p><a href="https://plone.org" target="_blank" rel="external">Plone</a>平台是开源的CMS平台，适合企业级的应用，有完善的权限管理以及流程支持，是目前开源CMS的翘楚。虽然个人网站极为渺小，但是通过实践一个优秀的开源产品，可以开阔思路和眼界。</p>
<blockquote>
<p>任何一个企业，企业知识的积累和传承是核心竞争能力。虽然目前所处的互联网行业热点瞬息万变，但是核心的知识管理依然是非常基础的管理要点。</p>
</blockquote>
<p>本文是单机简化部署Plone的记录，适合小型网站使用，大规模部署Plone需要集群多台服务器，后续再补充集群部署案例。</p>
<a id="more"></a>
<h1 id="Plone_u5B89_u88C5_u73AF_u5883_u9700_u6C42"><a href="#Plone_u5B89_u88C5_u73AF_u5883_u9700_u6C42" class="headerlink" title="Plone安装环境需求"></a>Plone安装环境需求</h1><ul>
<li>连接Internet（公开网站）或Intranet（私有内部网络）的服务器，需要能够SSH访问</li>
<li><p>操作系统 - Windows/Linux/BSD/OS X/Solaris之类的*nix系统</p>
</li>
<li><p>硬件（或虚拟机）需求 - 最少256MB内存和512MB swap，需要至少512MB磁盘空间；建议2G或以上内存，40G磁盘</p>
</li>
<li><p>软件：gcc, gmake, patch, tar, gunzip, bunzip2, wget 积极对应的dev软件包</p>
</li>
<li><p>可选软件： poppler-utils (PDFs) 和 wv (office docs)</p>
</li>
<li><p>Plone 4.3/4.2 需要 Python 2.7，并且要求支持 expat (xml.parsers.expat), zlib 和 ssl</p>
</li>
</ul>
<p>库文件</p>
<pre><code>libz (dev)
libjpeg (dev)*
readline (dev)*
libssl or openssl (dev)
libxml2 &gt;= 2.7.8 (dev)*
libxslt &gt;= 1.1.26 (dev)*
</code></pre><h1 id="CentOS_u5B89_u88C5Plone"><a href="#CentOS_u5B89_u88C5Plone" class="headerlink" title="CentOS安装Plone"></a>CentOS安装Plone</h1><p>准备依赖环境</p>
<pre><code>yum install gcc make patch tar gzip bzip2 wget
</code></pre><p>安装库依赖</p>
<pre><code>yum install libzip libzip-devel libjpeg-turbo libjpeg-turbo-devel openjpeg openjpeg-devel \
readline readline-devel openssl openssl-devel libxml2 libxml2-devel libxslt libxslt-devel
</code></pre><blockquote>
<p>感觉应该是安装 <code>openjpeg-devel</code> 为准</p>
</blockquote>
<p>根据后续的安装经验，还需要安装</p>
<pre><code>yum install python-devel
</code></pre><p>安装 poppler 和 wv</p>
<pre><code>yum install poppler
</code></pre><blockquote>
<p>wv 可以从 <a href="http://wvware.sourceforge.net" target="_blank" rel="external">http://wvware.sourceforge.net</a> 下载安装，不过版本已经很陈旧了，发行版现在也不包含这个软件包，所以没有安装</p>
</blockquote>
<h1 id="u5B89_u88C5Plone"><a href="#u5B89_u88C5Plone" class="headerlink" title="安装Plone"></a>安装Plone</h1><p>Plone提供了一个称为 <a href="http://docs.plone.org/manage/installing/installation.html#download-the-latest-plone-unified-installer" target="_blank" rel="external">Unified UNIX Installer</a> - 可以从 <a href="http://plone.org/download" target="_blank" rel="external">Plone Download页面下载</a></p>
<p>例如，安装 4.3.3 稳定版本</p>
<pre><code>wget --no-check-certificate https://launchpad.net/plone/4.3/4.3.3/+download/Plone-4.3.3-UnifiedInstaller.tgz
</code></pre><p>我使用了<a href="https://launchpad.net/plone/5.0/5.0a2/+download/Plone-5.0a2-UnifiedInstaller.tgz" target="_blank" rel="external">最新 Plone 5 非稳定发布版本</a></p>
<pre><code>tar xfz Plone-5.0a2-UnifiedInstaller.tgz
cd Plone-5.0a2-UnifiedInstaller
</code></pre><p>最简单的是Single Zope instance（单个Zope会话）安装，适合测试环境 - 对于大规模环境，则使用 <a href="http://plone.org/documentation/manual/installing-plone/installing-on-linux-unix-bsd" target="_blank" rel="external">clustered (ZEO) setup</a> 适合多核CPU的生产环境部署。</p>
<pre><code>./install.sh standalone
</code></pre><p>如果使用ZEO Cluster (ZEO server, 2 clients) </p>
<pre><code>./install.sh zeo
</code></pre><p>如果使用root用户身份安装，会将软件包安装到系统目录 <code>/usr/local/Plone</code></p>
<p>安装成功最后会提示默认 admin 帐号密码，请记录</p>
<p>启动 Plone</p>
<pre><code>sudo -u plone_daemon /usr/local/Plone/zinstance/bin/plonectl start
</code></pre><p>停止 Plone</p>
<pre><code>sudo -u plone_daemon /usr/local/Plone/zinstance/bin/plonectl stop
</code></pre><h1 id="u7B2C_u4E00_u6B21_u8BBF_u95EE_u548C_u521D_u59CB_u5316"><a href="#u7B2C_u4E00_u6B21_u8BBF_u95EE_u548C_u521D_u59CB_u5316" class="headerlink" title="第一次访问和初始化"></a>第一次访问和初始化</h1><p>第一次访问的时候，会提示创建一个 plone 网站</p>
<p><img src="/img/plone/plone_init.png" alt="Plone初始化"></p>
<blockquote>
<p>实际上Plone服务是一个多站点的服务，也就是默认 <a href="http://plone.huatai.me" target="_blank" rel="external">http://plone.huatai.me</a> 下面可以托管多个plone站点，所以第一次访问 <a href="http://plone.huatai.me" target="_blank" rel="external">http://plone.huatai.me</a> 并创建一个 <code>atlas</code> 站点以后，会生成 <a href="http://plone.huatai.me/Atlas" target="_blank" rel="external">http://plone.huatai.me/Atlas</a> 这个网站。</p>
<p>问题来了： 如何实现 Zope Virtual Host 功能，使得 <a href="http://atlas.huatai.me" target="_blank" rel="external">http://atlas.huatai.me</a> 替代 <a href="http://plone.huatai.me/Atlas" target="_blank" rel="external">http://plone.huatai.me/Atlas</a> ?</p>
</blockquote>
<p><a href="#Zope Plone多虚拟主机和Nginx反向代理设置">Zope Plone多虚拟主机和Nginx反向代理设置</a></p>
<h1 id="u5378_u8F7DPlone"><a href="#u5378_u8F7DPlone" class="headerlink" title="卸载Plone"></a>卸载Plone</h1><p>尝试了alpha 2版本的Plone 5以后发现比较怪异（有点缓慢并且设置Virtual Host遇到苦难），所以想回退到 Plone 4.3.3 稳定版本。参考 README.txt ，卸载的方法很简单:</p>
<ul>
<li><p>停止Plone</p>
</li>
<li><p>删除 <code>/usr/local/Plone</code> 或者 <code>$HOME/Plone</code> 目录</p>
</li>
</ul>
<h1 id="u5907_u4EFDPlone"><a href="#u5907_u4EFDPlone" class="headerlink" title="备份Plone"></a>备份Plone</h1><p>备份也同样简单:</p>
<ul>
<li><p>停止Plone</p>
</li>
<li><p>备份目录 <code>/usr/local/Plone</code> 或者 <code>$HOME/Plone</code> 目录</p>
<pre><code>tar -zcvf Plone-backup.tgz /usr/local/Plone
</code></pre></li>
</ul>
<p>在线备份也是可以的，参考 <a href="https://plone.org/documentation/kb/backup-plone" target="_blank" rel="external">Backup Plone</a></p>
<h1 id="u91CD_u65B0_u5B89_u88C5Plone_4"><a href="#u91CD_u65B0_u5B89_u88C5Plone_4" class="headerlink" title="重新安装Plone 4"></a>重新安装Plone 4</h1><p>由于Plone5的多虚拟主机（virtual host）没有设置成功，所以尝试重新安装 Plone 4。</p>
<p>删除了 <code>/usr/local/Plone</code> 目录之后</p>
<pre><code>wget --no-check-certificate https://launchpad.net/plone/4.3/4.3.3/+download/Plone-4.3.3-UnifiedInstaller.tgz
tar xfx Plone-4.3.3-UnifiedInstaller.tgz
cd Plone-4.3.3-UnifiedInstaller
./install.sh standalone
</code></pre><p>但是启动 <code>sudo -u plone_daemon /usr/local/Plone/zinstance/bin/plonectl start</code> 访问web页面出现报错</p>
<pre><code>Site Error

An error was encountered while publishing this resource.

Error Type: IOError
Error Value: (2, &apos;No such file or directory&apos;)
</code></pre><p>这个问题参考 <a href="http://plone.293351.n2.nabble.com/Plone-re-install-td1663938.html" target="_blank" rel="external">Plone re-install </a> 原因是前一次安装的Plone进程没有杀掉导致的。原来plone的停止命令可能没有杀干净plone进程，然后删除了旧版本安装新版本，启动实际就有冲突。</p>
<p>解决的方法是使用 <code>kill</code> 命令彻底杀死掉plone进程，再次启动就不再报错。</p>
<h1 id="u53C2_u8003"><a href="#u53C2_u8003" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="http://docs.plone.org/manage/installing/" target="_blank" rel="external">Installing Plone</a></li>
</ul>

            
                

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">標籤</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/CMS/">CMS</a> <a class="tag tag--primary tag--small t-link" href="/tags/Plone/">Plone</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/10/18/seagate-goflex-home-nas-install-arch-linux-arm/"  data-tooltip="Seagate GoFlex Home网络存储安装Arch Linux ARM">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/10/14/mac-os-x-mount-linux-nfs/" data-tooltip="Mac OS X挂载Linux卷（NFS）">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2016 阿泰. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/10/18/seagate-goflex-home-nas-install-arch-linux-arm/"  data-tooltip="Seagate GoFlex Home网络存储安装Arch Linux ARM">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/10/14/mac-os-x-mount-linux-nfs/" data-tooltip="Mac OS X挂载Linux卷（NFS）">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-google-plus"></i><span class="">分享到 Google+</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://blog.huatai.me/2014/10/17/plone-quick-deploy/">
                <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <h4 id="about-card-name">阿泰</h4>
        
            <h5 id="about-card-bio"><p>author.bio</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </h5>
        
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/scrip-gfmrkxcl0qohe3cfdgxhzvc0yrceqta8i4iix0txvn8q4o2adlqd5n0jmkvt.min.js" type="text/javascript"></script>
<!--SCRIPTS END-->

    



</html>
